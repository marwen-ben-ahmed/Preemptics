| **Ref** | **Agent**              | **Description (R√¥le principal)**                                                                                        | **Exemple d‚ÄôInput**                                                                              | **Exemple d‚ÄôOutput**                                                                                                                              | **Mod√®le Open Source conseill√©**                                          | **Pourquoi ce choix**                                             |
| ------- | ---------------------- | ----------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- | ----------------------------------------------------------------- |
| **A1**  | **Ingest Agent**       | Ing√®re CTI (feeds, IOC JSON, logs bruts), normalise et convertit syst√©matiquement en **STIX2.1**.                       | IOC brut : `{ "hash": "abcd...", "type": "file" }`                                               | STIX2.1 Object : `{ "type": "indicator", "spec_version": "2.1", "pattern": "[file:hashes.'SHA-256' = 'abcd...']", "labels": ["malicious-file"] }` | **Llama 3 (8B/70B)** ou **Mistral 7B** (fine-tuned parsing CTI ‚Üí STIX2.1) | Excellents pour produire du JSON STIX2.1 strict et stable.        |
| **A2**  | **Mapping Agent**      | Lit le STIX2.1 produit par A1 et enrichit avec les **TTPs MITRE ATT\&CK** (repo officiel ATT\&CK en dataset fine-tune). | Input STIX2.1 : `{ "type": "indicator", "pattern": "[process:command_line LIKE '%rundll32%']" }` | Enrichi : `{ "indicator": "...", "attack_patterns": [{ "tactic": "Execution", "technique": "T1218.011 Rundll32", "confidence": 0.9 }] }`          | **Llama 3 fine-tuned sur MITRE** ou **Falcon 40B**                        | Mapping taxonomique complexe, fine-tuning crucial pour pr√©cision. |
| **A3**  | **Hypothesis Agent**   | G√©n√®re hypoth√®ses de chasse bas√©es sur le STIX2.1 enrichi par A2.                                                       | Input : STIX2.1 avec attack\_patterns                                                            | Output : `"Hypothesis": "L‚Äôattaquant a utilis√© Rundll32.exe (T1218.011) pour ex√©cuter du code malveillant et √©chapper √† la d√©tection."`           | **Mixtral 8x7B**                                                          | Raisonnement step-by-step id√©al pour hypoth√®ses cyber.            |
| **A4**  | **Playbook Agent**     | G√©n√®re des playbooks SOC (Kestrel queries, Sigma rules) √† partir des hypoth√®ses (A3).                                   | Input : `"Hypothesis: Rundll32.exe Execution"`                                                   | Output : `LET processes = GET process WHERE command_line LIKE "%rundll32%"`                                                                       | **Code Llama** ou **StarCoder 2**                                         | Optimis√©s pour g√©n√©ration de code SOC.                            |
| **A5**  | **RAG Agent**          | Fournit le contexte externe (descriptions MITRE, CTI reports) pour enrichir les autres agents.                          | Query : `"Explain T1218.011"`                                                                    | `{ "technique": "T1218.011 Rundll32", "description": "Execution of DLLs using rundll32.exe" }`                                                    | **Weaviate / Qdrant / Milvus + LlamaIndex**                               | Sert de m√©moire cyber sp√©cialis√©e.                                |
| **A6**  | **Orchestrator Agent** | Supervise les flux entre A1 ‚Üí A5, valide coh√©rence STIX2.1 et r√©sultats.                                                | Pipeline multi-agents                                                                            | R√©sultat coh√©rent : STIX2.1 enrichi + hypoth√®ses + playbooks                                                                                      | **Llama 3 8B** ou **Mistral 7B**                                          | L√©ger, fiable pour coordination et validation JSON.               |


# Best models 2025

# üîê Agents Array

| **Ref** | **Agent** | **Description (Role / Main Function)** | **Example Input** | **Example Output** | **Best Model (2025)** | **Next Agent / Flow** | **Requirements** |
|---------|-----------|----------------------------------------|-----------------|------------------|----------------------|---------------------|----------------|
| **A1** | Ingest Agent | Ingests raw CTI (feeds, IOC JSON, logs) and normalizes into **STIX2.1** format. | `{ "hash": "abcd...", "type": "file" }` | STIX2.1 Object | Mistral-Nemo 12B or Phi-3 Medium | A2 ‚Äì Mapping | Medium GPU or CPU, 16‚Äì32GB RAM |
| **A2** | Mapping Agent | Reads STIX2.1 from A1 and enriches with **MITRE ATT&CK TTPs** | STIX2.1 object | STIX2.1 + TTPs | Llama 3.1 70B fine-tuned MITRE | A3 ‚Äì Hypothesis | High-end GPU recommended (‚â•48GB VRAM), else CPU fallback with small model |
| **A3** | Hypothesis Agent | Generates hunting hypotheses | STIX2.1 + TTPs | Hypotheses | Mixtral 8x7B | A4 ‚Äì Playbook | Medium GPU or CPU, 16‚Äì32GB RAM |
| **A4** | Playbook Agent | Produces SOC playbooks (Kestrel/Sigma) | Hypotheses + TTPs | Playbooks + Kestrel | CodeGemma 7B/9B or DeepSeek-Coder V2 | A6 ‚Äì Orchestrator | Medium GPU or CPU, 16‚Äì32GB RAM |
| **A5** | RAG Agent | Context enrichment (MITRE/CTI) | Query from A2/A3/A4 | Context info | Weaviate / Qdrant / Milvus + LlamaIndex | Supports A2, A3, A4 | CPU-only feasible, RAM depends on dataset size |
| **A6** | Orchestrator Agent | Supervises workflow, validates outputs | Pipeline outputs | Final validated STIX2.1 + TTPs + Hypotheses + Playbooks | Phi-3 Small or Mistral 7B | End-user SOC | CPU or low-end GPU, 8‚Äì16GB RAM |


# üîê Agents Array ‚Äì Models Adjusted for Dell i7, 32GB RAM

| **Ref** | **Agent** | **Description (Role / Main Function)** | **Example Input** | **Example Output** | **Best Model (CPU-friendly)** | **Next Agent / Flow** | **Requirements** |
|---------|-----------|----------------------------------------|-----------------|------------------|-----------------------------|---------------------|----------------|
| **A1** | Ingest Agent | Normalize raw CTI ‚Üí STIX2.1 | `{ "hash": "abcd...", "type": "file" }` | STIX2.1 Object | **Phi-3 Medium (quantized 8-bit)** | A2 ‚Äì Mapping | CPU only, 32GB RAM |
| **A2** | Mapping Agent | STIX2.1 ‚Üí enriched with MITRE TTPs | STIX2.1 | STIX2.1 + TTPs | **Llama 3.1 7B quantized / Zephyr-7B fine-tuned MITRE** | A3 ‚Äì Hypothesis | CPU only, 32GB RAM, slower inference |
| **A3** | Hypothesis Agent | Generate hunting hypotheses | STIX2.1 + TTPs | Hypotheses | **Mixtral 4x7B quantized** | A4 ‚Äì Playbook | CPU only, 32GB RAM |
| **A4** | Playbook Agent | Generate playbooks / Kestrel queries | Hypotheses + TTPs | Playbooks + Kestrel | **CodeGemma 7B quantized** | A6 ‚Äì Orchestrator | CPU only, 32GB RAM |
| **A5** | RAG Agent | Context enrichment (MITRE/CTI) | Query | Context info | **Llama 2 7B or Phi-3 Small** embeddings via LlamaIndex | Supports A2, A3, A4 | CPU only, RAM depends on dataset |
| **A6** | Orchestrator Agent | Supervises workflow, validates outputs | Pipeline outputs | Final validated STIX2.1 + TTPs + Hypotheses + Playbooks | **Phi-3 Small (3.8B quantized)** | End-user SOC | CPU only, 16‚Äì32GB RAM |
